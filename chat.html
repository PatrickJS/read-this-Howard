<!doctype html>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="https://www.firebase.com/css/example.css">
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.2/angular.min.js"></script>
    <script src="https://cdn.firebase.com/v0/firebase.js"></script>
    <script src="https://cdn.firebase.com/libs/angularfire/0.3.0/angularfire.min.js"></script>
    <script src="http://momentjs.com/downloads/moment.min.js"></script>
  </head>
  <body ng-app="chat" ng-controller="MyController">
    <div id="messagesDiv">
      <div ng-repeat="msg in messages"><em>{{ msg.from }}</em>: {{ msg.body }}   <small>{{ msg.date }}</small><small></div>
    </div>
    <input type="text" ng-model="name" placeholder="Name">
    <input type="text" ng-model="msg" ng-keydown="addMessage($event)" placeholder="Message...">
    <script>
      angular.module("chat", [
        "firebase"
      ]);

      function MyController($scope, angularFire) {
        var ref = new Firebase("https://gdi2290.firebaseio-demo.com/");

        $scope.messages = [];

        angularFire(ref, $scope, "messages");

        $scope.addMessage = function(e) {
          if (e.keyCode != 13) return;
          var currentDate = new Date();
          $scope.messages.push({
            from: $scope.name,
            body: $scope.msg,
            date: moment(currentDate).fromNow()
          });
          $scope.msg = "";
        };
      }
    </script>
  </body>
</html>
